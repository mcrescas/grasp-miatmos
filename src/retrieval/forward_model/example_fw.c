//
// Created by  Juan Carlos Antuña-Sánchez on 10/8/21.
//
#include "external_interface.h"
#include "stdio.h"


int main(int argc, char** argv){

    radiative_transfer_args rt_args = {
            1,
            15,
            5,
            4,
            1,
            0,
            0,
            0.0,
            15,
            {51, 51},
            24.1095009,
            1,
            {[0 ... (2*_NBVM - 1)] = 58.8371010},
            {[0 ... (2*_NBVM - 1)] = 107.692001},
            0.442999989,
            4,
            3,
            {9.99999940E-02, 9.99999940E-02, 9.99999940E-02, 2.09999990, 0.00000000, 0.00000000, 0.00000000, 0.00000000},
            3,
            {9.99999978E-03, 0.899999976, 9.99999978E-03, 0.00000000},
            {0.267643005, 0.234841362, 0.00000000, 0.00000000},
            {0.959613979, 1.00000000, 0.00000000, 0.00000000},
            35,
            {0.00000000, 2.59999990, 3.46000004, 5.19999981, 6.92999983, 8.65999985, 10.3900003, 12.1199999,
             15.5699997, 17.2999992, 21.6100006, 25.8999996, 30.1900005, 42.9399986, 59.5699997, 67.6500015,
             75.5199966, 83.1200027, 97.1800003, 108.940002, 117.050003, 120.000000, 125.000000, 130.000000,
             135.000000, 140.000000, 147.500000, 154.300003, 165.000000, 167.699997, 170.000000, 172.500000,
             175.000000, 177.500000, 180.000000},
            {9.99999978E-03, 9.99999978E-03, 9.99999978E-03, 9.99999978E-03, 9.99999978E-03, 0.00000000,
             0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,
             0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000},
            {0.0},
            705.000061,
            5.70000038E-02,
            40.00,
            1,
            {0.0},
            {2500.00024, },
            {0.0},
            1,
            0.0,
            {0.0},
            0.0,
            true,
            true,
            false,
            false,
            {47.6394730, 25.1858082, 21.0667286, 16.3418388, 13.7347383, 12.0047817, 10.7165308, 9.67327309,
             8.00905132, 7.30169582, 5.79060984, 4.58816767, 3.63343048, 1.84604311, 0.825588465, 0.582695842,
             0.427834779, 0.327849090, 0.218963295, 0.171959251, 0.154124215, 0.149824232, 0.144890025,
             0.142721251, 0.142901465, 0.145416722, 0.152995154, 0.163561746, 0.185849935, 0.191917032,
             0.199015573, 0.209076643, 0.220770255, 0.230718821, 0.236013860},
            {0.00000000, 4.05577524E-03, 3.56888003E-03, 4.45997663E-04, -3.75478878E-03, -8.89717322E-03,
             -1.48161594E-02, -2.11354494E-02, -3.43322791E-02, -4.10582796E-02, -5.72876073E-02,
             -7.23126084E-02, -8.56272876E-02, -0.110879928, -0.114230826, -0.107783630, -9.89508554E-02,
             -8.90221745E-02, -6.87668994E-02, -5.10714054E-02, -3.84344980E-02, -3.36857624E-02,
             -2.54153088E-02, -1.68152470E-02, -7.77174300E-03, 1.78835704E-03, 1.65786669E-02, 2.79730763E-02,
             2.74789724E-02, 2.28554234E-02, 1.83241535E-02, 1.30986366E-02, 7.72413658E-03, 2.53695110E-03,
             0.00000000},
            {47.6055565, 25.1522102, 21.0333500, 16.3089886, 13.7024345, 11.9730206, 10.6853151, 9.64260006,
             7.97946024, 7.27264547, 5.76288128, 4.56169367, 3.60811734, 1.82349455, 0.805077851, 0.562627792,
             0.408007652, 0.308231860, 0.200011909, 0.154078543, 0.137298390, 0.133439690, 0.129311681,
             0.128011063, 0.129109219, 0.132569984, 0.141492903, 0.152809039, 0.173424914, 0.178088129,
             0.183630720, 0.191610798, 0.200902894, 0.208809704, 0.213459611},
            {47.6055603, 25.1505642, 21.0305271, 16.3032360, 13.6939840, 11.9619455, 10.6717644, 9.62655735,
             7.95972013, 7.25124741, 5.73679686, 4.52994490, 3.59252405, 1.80358493, 0.734181881, 0.483873099,
             0.322244704, 0.215602994, 9.43241045E-02, 3.60917896E-02, 8.64461996E-03, 3.57155310E-04,
             -1.21472636E-02, -2.32224539E-02, -3.35234515E-02, -4.37801108E-02, -6.10400252E-02,
             -8.14868510E-02, -0.125870556, -0.137827367, -0.149198964, -0.164411560, -0.183045253,
             -0.203353629, -0.213638574},
             0,
            {0},
            true,
            false,
            1,
            {1},
            100,
            {0.0},
            2,
            1,
            1,
            0,
            {2.50131297, 7.94906139, 0.00000000, 0.00000000},
            false,
            true,
            true,
            true,
            false,
            false,
            false,
            false,
            false,
            false,
            true,
            false,
            true,
            false,
            true,
            false,
            false,
            false,
            false,
            false,
            0,
            0,
            1,
            {5, 0},
            {50, 59},
            5.00000024E-04
    };

    radiative_transfer_result rt_results = {{0}, {0}, {0}, {0}, {0}, 0, {0}, {0}};

    grasp_rt_sos(&rt_args, &rt_results);

    printf("FW-C-example\n");
    printf("Expected: 0.134284660\n");
    printf("Radiance: %1.20f \n", rt_results.SLout[0] );

}
